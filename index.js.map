{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const PER_PAGE = 40;\n\nconst API_KEY = '53049514-dee19204cd3e9e15730e86423'; \nconst api = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n  },\n});\n\n/**\n * @param {string} query - пошуковий запит\n * @param {number} page  - сторінка (1..n)\n * @returns {Promise<{totalHits:number, hits:Array}>}\n */\nexport async function getImagesByQuery(query, page = 1) {\n  const { data } = await api.get('', { params: { q: query, page } });\n  return data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst gallery = document.querySelector('#gallery');\nconst loader  = document.querySelector('#loader');\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true, captionsData: 'alt', captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images.map(cardTpl).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() { loader.hidden = false; }\nexport function hideLoader() { loader.hidden = true; }\n\nexport function showInfo(message) {\n  iziToast.info({ message, position: 'topRight' });\n}\nexport function showSuccess(message) {\n  iziToast.success({ message, position: 'topRight' });\n}\nexport function showError(message) {\n  iziToast.error({ message, position: 'topRight' });\n}\n\nexport function smoothScrollAfterAppend() {\n  const first = gallery.firstElementChild;\n  if (!first) return;\n  const { height } = first.getBoundingClientRect();\n  window.scrollBy({ top: height * 2, behavior: 'smooth' });\n}\n\nfunction cardTpl({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) {\n  return `\n<li class=\"photo-card\">\n  <a href=\"${largeImageURL}\" class=\"gallery__link\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n    <p><b>Likes</b> ${likes}</p>\n    <p><b>Views</b> ${views}</p>\n    <p><b>Comments</b> ${comments}</p>\n    <p><b>Downloads</b> ${downloads}</p>\n  </div>\n</li>`;\n}\n\n","// src/main.js\nimport { getImagesByQuery, PER_PAGE } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showInfo,\n  showSuccess,\n  showError,\n  smoothScrollAfterAppend,\n} from './js/render-functions.js';\n\n\n\nconst refs = {\n  form: document.querySelector('#search-form'),\n  input: document.querySelector('#search-form [name=\"query\"]'),\n  gallery: document.querySelector('#gallery'),\n  loadMore: document.querySelector('#load-more'),\n};\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadMore.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n  query = refs.input.value.trim();\n  if (!query) {\n    showInfo('Enter a search term'); \n    return;\n  }\n\n  page = 1;\n  totalHits = 0;\n  clearGallery();\n  toggleMore(false);\n\n  showLoader();\n  try {\n    const data = await getImagesByQuery(query, page);\n    totalHits = data.totalHits;\n\n    if (!totalHits) {\n      showError('Sorry, no images match your search query.');\n      return;\n    }\n\n    createGallery(data.hits);\n    showSuccess(`Hooray! We found ${totalHits} images.`);\n\n    if (page * PER_PAGE < totalHits) toggleMore(true);\n  } catch (err) {\n    console.error(err);\n    showError('Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n  toggleMore(false);\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    createGallery(data.hits);\n\n    // кінець списку\n    if (page * PER_PAGE >= totalHits) {\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    } else {\n      toggleMore(true);\n    }\n\n    smoothScrollAfterAppend();\n  } catch (err) {\n    console.error(err);\n    showError('Something went wrong, try again later.');\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction toggleMore(show) {\n  refs.loadMore.hidden = !show;\n}\n"],"names":["PER_PAGE","API_KEY","api","axios","getImagesByQuery","query","page","data","gallery","loader","lightbox","SimpleLightbox","createGallery","images","markup","cardTpl","clearGallery","showLoader","hideLoader","showInfo","message","iziToast","showSuccess","showError","smoothScrollAfterAppend","first","height","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","totalHits","onSearch","onLoadMore","toggleMore","err","show"],"mappings":"owBAEO,MAAMA,EAAW,GAElBC,EAAU,qCACVC,EAAMC,EAAM,OAAO,CACvB,QAAS,2BACT,OAAQ,CACN,IAAKF,EACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUD,CACX,CACH,CAAC,EAOM,eAAeI,EAAiBC,EAAOC,EAAO,EAAG,CACtD,KAAM,CAAE,KAAAC,CAAM,EAAG,MAAML,EAAI,IAAI,GAAI,CAAE,OAAQ,CAAE,EAAGG,EAAO,KAAAC,CAAI,CAAI,CAAA,EACjE,OAAOC,CACT,CClBA,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAU,SAAS,cAAc,SAAS,EAEhD,IAAIC,EAAW,IAAIC,EAAe,aAAc,CAC9C,SAAU,GAAM,aAAc,MAAO,aAAc,GACrD,CAAC,EAEM,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAASD,EAAO,IAAIE,CAAO,EAAE,KAAK,EAAE,EAC1CP,EAAQ,mBAAmB,YAAaM,CAAM,EAC9CJ,EAAS,QAAO,CAClB,CAEO,SAASM,GAAe,CAC7BR,EAAQ,UAAY,EACtB,CAEO,SAASS,GAAa,CAAER,EAAO,OAAS,EAAQ,CAChD,SAASS,GAAa,CAAET,EAAO,OAAS,EAAO,CAE/C,SAASU,EAASC,EAAS,CAChCC,EAAS,KAAK,CAAE,QAAAD,EAAS,SAAU,UAAY,CAAA,CACjD,CACO,SAASE,EAAYF,EAAS,CACnCC,EAAS,QAAQ,CAAE,QAAAD,EAAS,SAAU,UAAY,CAAA,CACpD,CACO,SAASG,EAAUH,EAAS,CACjCC,EAAS,MAAM,CAAE,QAAAD,EAAS,SAAU,UAAY,CAAA,CAClD,CAEO,SAASI,GAA0B,CACxC,MAAMC,EAAQjB,EAAQ,kBACtB,GAAI,CAACiB,EAAO,OACZ,KAAM,CAAE,OAAAC,CAAM,EAAKD,EAAM,sBAAqB,EAC9C,OAAO,SAAS,CAAE,IAAKC,EAAS,EAAG,SAAU,QAAQ,CAAE,CACzD,CAEA,SAASX,EAAQ,CAAE,aAAAY,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,GAAa,CACzF,MAAO;AAAA;AAAA,aAEIL,CAAa;AAAA,gBACVD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA,sBAGpBC,CAAK;AAAA,sBACLC,CAAK;AAAA,yBACFC,CAAQ;AAAA,0BACPC,CAAS;AAAA;AAAA,MAGnC,CCzCA,MAAMC,EAAO,CACX,KAAM,SAAS,cAAc,cAAc,EAC3C,MAAO,SAAS,cAAc,6BAA6B,EAC3D,QAAS,SAAS,cAAc,UAAU,EAC1C,SAAU,SAAS,cAAc,YAAY,CAC/C,EAEA,IAAI7B,EAAQ,GACRC,EAAO,EACP6B,EAAY,EAEhBD,EAAK,KAAK,iBAAiB,SAAUE,CAAQ,EAC7CF,EAAK,SAAS,iBAAiB,QAASG,CAAU,EAElD,eAAeD,EAAS,EAAG,CAGzB,GAFA,EAAE,eAAc,EAChB/B,EAAQ6B,EAAK,MAAM,MAAM,KAAI,EACzB,CAAC7B,EAAO,CACVc,EAAS,qBAAqB,EAC9B,MACD,CAEDb,EAAO,EACP6B,EAAY,EACZnB,IACAsB,EAAW,EAAK,EAEhBrB,IACA,GAAI,CACF,MAAMV,EAAO,MAAMH,EAAiBC,EAAOC,CAAI,EAG/C,GAFA6B,EAAY5B,EAAK,UAEb,CAAC4B,EAAW,CACdZ,EAAU,2CAA2C,EACrD,MACD,CAEDX,EAAcL,EAAK,IAAI,EACvBe,EAAY,oBAAoBa,CAAS,UAAU,EAE/C7B,EAAON,EAAWmC,GAAWG,EAAW,EAAI,CACjD,OAAQC,EAAK,CACZ,QAAQ,MAAMA,CAAG,EACjBhB,EAAU,wCAAwC,CACtD,QAAY,CACRL,GACD,CACH,CAEA,eAAemB,GAAa,CAC1B/B,GAAQ,EACRgC,EAAW,EAAK,EAChBrB,IAEA,GAAI,CACF,MAAMV,EAAO,MAAMH,EAAiBC,EAAOC,CAAI,EAC/CM,EAAcL,EAAK,IAAI,EAGnBD,EAAON,GAAYmC,EACrBhB,EAAS,4DAA4D,EAErEmB,EAAW,EAAI,EAGjBd,GACD,OAAQe,EAAK,CACZ,QAAQ,MAAMA,CAAG,EACjBhB,EAAU,wCAAwC,CACtD,QAAY,CACRL,GACD,CACH,CAEA,SAASoB,EAAWE,EAAM,CACxBN,EAAK,SAAS,OAAS,CAACM,CAC1B"}